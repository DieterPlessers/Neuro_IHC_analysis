# Neuro_IHC_analysis

## Introduction
This repository contains the code accompanying the paper [“Development of convolutional neural networks for automated brain-wide histopathological analysis in mouse models of synucleinopathies”](https://www.nature.com/articles/s41531-025-01170-1). 

Each Python Notebook automates the processing of raw data generated by **CNN-based analysis of stained mouse brains** on the Aiforia platform. A dedicated Notebook was developed to analyze the output of each CNN model described in the paper.

Each of these Notebooks combine data from subregions that belong to the same class and perform model-specific calculations. For the common “Brain region” layer, each subregion detected within multiple tissue sections that corresponds to the same brain region will be merged and processed together. Therefore, the code provides separate results for **each brain region for multiple animals simultaneously**. 

Additionally, all Notebooks offer both **brain-wide analysis** (results from both hemispheres combined) and **hemisphere comparison analysis** (contralateral vs. ipsilateral) for brain regions that are not physically connected (striatum, substantia nigra, amygdala, globus pallidus, etc.). Select Notebooks offer the option to include a quality control of the raw data, defined by the researcher. The Notebook for each model generates various output readouts to provide a comprehensive overview of the marker assessed. 

## Available Notebooks

- [DCD_Dopaminergic_Cell_Detector_Analysis](./Notebooks/DCD_Dopaminergic_Cell_Detector_Analysis.ipynb) is used to analyse the data from the Aiforia model “Dopaminergic Cell Detector (DCD)” which investigates the tyrosine hydroxylase (TH) marker in the mouse substantia nigra region.

- [DAD_Dopaminergic_Axon_Detector_Analysis](./Notebooks/DAD_Dopaminergic_Axon_Detector_Analysis.ipynb) is used to analyse the data from the Aiforia model “Dopaminergic Axon Detector (DAD)” which investigates the tyrosine hydroxylase (TH) marker in the mouse dorsal striatum region.
  
- [NCD_Neuronal_Cell_Detector_Analysis](./Notebooks/NCD_Neuronal_Cell_Detector_Analysis.ipynb) is used to analyse the data from the Aiforia model “Neuronal Cell Detector (NCD)” which investigates the neuronal nuclear antigen (NeuN) marker in the whole mouse brain.
  
- [MCD_Microglial_Cell_Detector_Analysis](./Notebooks/MCD_Microglial_Cell_Detector_Analysis.ipynb) is used to analyse the data from the Aiforia model “Microglial Cell Detector (MCD)” which investigates the ionized calcium-binding adaptor molecule 1 (Iba1) marker in the whole mouse brain.
  
- [pSynD_Phospho_Synuclein_Detector_Analysis](./Notebooks/pSynD_Phospho_Synuclein_Detector_Analysis.ipynb) is used to analyse the data from the Aiforia model “pSer129-α-Synuclein Detector (pSynD)” which investigates the phosphorylated-Serine-129-α-Synuclein (p129Ser-α-Syn) marker in the whole mouse brain.
  
[Example MCD raw data and output files (brain-wide and hemisphere analyses)](./Microglial%20Cell%20Detector%20Example) are provided for two mouse brains, each mounted on two glass slides.

## Prerequisites

A recent Python installation (e.g. Python 3.8 or newer) with common data-analysis libraries available, such as NumPy and Pandas. These are included by default in distributions like Anaconda, but can also be installed manually via pip.
